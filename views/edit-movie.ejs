<%- include('partials/header', { title: 'Edit Movie', user: user }) %>

<div class="container page-container">
    <h1>Edit Movie</h1>

    <% if (errors.length > 0) { %>
        <div class="error">
            <% errors.forEach(error => { %>
                <p><%= error.msg %></p>
            <% }) %>
        </div>
    <% } %>

    <form method="POST" action="/movies/<%= movie._id %>/edit" class="form-card">
        <div>
            <label>Movie Name:</label>
            <input type="text" name="name" value="<%= movie.name %>" required>
        </div>

        <div>
            <label>Description:</label>
            <textarea name="description" required><%= movie.description %></textarea>
        </div>

        <div class="form-row">
            <div class="form-field">
                <label>Release Year:</label>
                <input type="number"
                       name="year"
                       value="<%= movie.year %>"
                       min="1888"
                       max="<%= new Date().getFullYear() + 5 %>"
                       required>
            </div>

            <div class="form-field">
                <label>Rating (0-10):</label>
                <input type="number"
                       name="rating"
                       value="<%= movie.rating %>"
                       min="0"
                       max="10"
                       step="0.1"
                       required>
            </div>

            <div class="form-field">
                <label>Duration (minutes):</label>
                <input type="number"
                       name="duration"
                       value="<%= movie.duration %>"
                       min="1"
                       required>
            </div>
        </div>

        <div>
            <label>Genres:</label>
            <div class="genres-grid">
                <% const genresList = ['Action', 'Comedy', 'Drama', 'Horror', 'Sci-Fi', 'Romance', 'Thriller']; %>
                <% genresList.forEach(genre => { %>
                    <label>
                        <input type="checkbox"
                               name="genres"
                               value="<%= genre %>"
                               <%= movie.genres.includes(genre) ? 'checked' : '' %>>
                        <%= genre %>
                    </label>
                <% }) %>
            </div>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn">Update Movie</button>
            <a href="/movies/<%= movie._id %>" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>

<%- include('partials/footer') %>
